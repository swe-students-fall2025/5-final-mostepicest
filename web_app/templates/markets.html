{% extends "base.html" %}
{% block title %}Markets • PolyPaper{% endblock %}

{% block content %}

<section class="markets-header">
  <div class="header-left">
    <h1 class="page-title">Markets</h1>
    <p class="page-subtitle">
      Search for event markets and practice trading without the risk.
    </p>
  </div>

  <form class="positions-search" method="get" action="{{ url_for('markets') }}">
    <input
      type="text"
      name="q"
      placeholder="Search by question or keyword"
      value="{{ query or '' }}"
    >
    <button class="btn-filter" type="submit">Search</button>
  </form>
</section>

{% if markets %}
<section class="markets-grid">
  {% for m in markets %}
  <article class="card market-card">
    <div class="card-header">
      <div class="card-title">{{ m.question }}</div>
      <div class="card-subtitle">
        {{ m.category }} • {{ m.region }}
      </div>
    </div>

    <div class="card-main">
      <div class="market-prices">
        <span class="value-chip positive">
          Yes: {{ "%.2f"|format(m.outcomePrices[0] | float * 100) }}%
        </span>
        <span class="value-chip negative">
          No: {{ "%.2f"|format(m.outcomePrices[1] | float * 100) }}%
        </span>
      </div>
    </div>

   <div class="card-actions">
  <a class="btn-outline" href="{{ url_for('market_details', slug=m['slug']) }}">
    Open market
  </a>
</div>
  </article>
  {% endfor %}
</section>
{% else %}
<div class="empty-state">
  {% if query %}
    <p>No markets found for “{{ query }}”.</p>
    <p class="hint">Try another keyword or region.</p>
  {% else %}
    <p>No markets available yet.</p>
    <p class="hint">The API team will hook this up to real data soon.</p>
  {% endif %}
</div>
{% endif %}

{% endblock %}
